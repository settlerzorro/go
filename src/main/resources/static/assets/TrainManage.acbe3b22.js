import{D as e,E as l,r as a,G as r,o,f as u,g as t,h as m,i as d,H as n,c as i,j as s,t as p,F as c,m as g,w as f,L as b}from"./vendor.17702b23.js";import{_ as V,j as y,k as w,l as z,m as v,n as h}from"./index.57ddd9f5.js";const P={name:"trainManage",setup(){const a=e({fromStation:"大连",toStation:null,fromDate:null,pageIndex:1,pageSize:10}),r=e({pageIndex:1,pageSize:5}),o=l(!1),u=l([]),t=l([]),m=l(0),d=l(0),n=()=>{o.value=!0,y(a).then((e=>{0==e.code?(u.value=e.data,m.value=e.data.length):f.error(e.message),o.value=!1}))};n();const i=l(!1),s=l(!1);let p="add";const c=l("新增"),g=l(null),V=e([{label:"G",value:"G"},{label:"K",value:"K"},{label:"T",value:"T"},{label:"D",value:"D"}]);let P=e({id:null,trainNo:null,trainCode:null,trainType:null,fromStation:"大连",toStation:null,fromTime:null,toTime:null,runTime:null,canBook:null,swzNum:null,swzPrice:null,ydzNum:null,ydzPrice:null,edzNum:null,edzPrice:null,gjrwNum:null,gjrwPrice:null,rwNum:null,rwPrice:null,dwNum:null,dwPrice:null,ywNum:null,ywPrice:null,rzNum:null,rzPrice:null,yzNum:null,yzPrice:null,wzNum:null,wzPrice:null,qtNum:null,qtPrice:null,trainLines:null,fromDate:null,buyUrl:null});const N=e({trainNo:[{required:!0,message:"请输入列车号",trigger:"blur"}],trainCode:[{required:!0,message:"请输入车次",trigger:"blur"}],trainType:[{required:!0,message:"请选择车次类型",trigger:"blur"}],fromStation:[{required:!0,message:"请选择出发站点",trigger:"blur"}],toStation:[{required:!0,message:"请输入到达站点",trigger:"blur"}],fromTime:[{required:!0,message:"请选择出发时间",trigger:"blur"}],toTime:[{required:!0,message:"请选择到达时间",trigger:"blur"}],runTime:[{required:!0,message:"请输入运行时间",trigger:"blur"}],canBook:[{required:!0,message:"请选择是否有余票",trigger:"blur"}],swzNum:[{required:!0,message:"请输入商务座/特等座剩余票数",trigger:"blur"}],swzPrice:[{required:!0,message:"请输入商务座/特等座价格",trigger:"blur"}],ydzNum:[{required:!0,message:"请输入一等座剩余票数",trigger:"blur"}],ydzPrice:[{required:!0,message:"请输入一等座价格",trigger:"blur"}],edzNum:[{required:!0,message:"请输入二等座剩余",trigger:"blur"}],edzPrice:[{required:!0,message:"请输入二等座价格",trigger:"blur"}],gjrwNum:[{required:!0,message:"请输入高级软卧剩余票数",trigger:"blur"}],gjrwPrice:[{required:!0,message:"请输入高级软卧价格",trigger:"blur"}],rwNum:[{required:!0,message:"请输入软卧/一等卧剩余票数",trigger:"blur"}],rwPrice:[{required:!0,message:"请输入软卧/一等卧价格",trigger:"blur"}],dwNum:[{required:!0,message:"请输入动卧剩余票数",trigger:"blur"}],dwPrice:[{required:!0,message:"请输入动卧价格",trigger:"blur"}],ywNum:[{required:!0,message:"请输入硬卧剩余票数",trigger:"blur"}],ywPrice:[{required:!0,message:"请输入硬卧价格",trigger:"blur"}],rzNum:[{required:!0,message:"请输入软卧剩余票数",trigger:"blur"}],rzPrice:[{required:!0,message:"请输入软卧价格",trigger:"blur"}],yzNum:[{required:!0,message:"请输入硬座剩余票数",trigger:"blur"}],yzPrice:[{required:!0,message:"请输入硬座价格",trigger:"blur"}],wzNum:[{required:!0,message:"请输入无座剩余票数",trigger:"blur"}],wzPrice:[{required:!0,message:"请输入无座价格",trigger:"blur"}],qtNum:[{required:!0,message:"请输入其他剩余票数",trigger:"blur"}],qtPrice:[{required:!0,message:"请输入其他价格",trigger:"blur"}],trainLines:[{required:!0,message:"请输入车次经停站点",trigger:"blur"}],fromDate:[{required:!0,message:"请选择发车日期",trigger:"blur"}]});return{loading:o,query:a,commentQuery:r,tableData:u,commentTableData:t,pageTotal:m,commentPageTotal:d,editVisible:i,commentVisible:s,formRef:g,form:P,rules:N,dialogTitle:c,handleSearch:()=>{a.pageIndex=1,n()},handlePageChange:e=>{a.pageIndex=e},handleDelete:(e,l)=>{b.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{v(l.id).then((e=>{0==e.code?(f.success("删除成功"),n()):f.error("删除失败")})).catch((()=>{f.error("删除失败")}))})).catch((()=>{}))},handleEdit:(e,l)=>{Object.keys(P).forEach((e=>{P[e]=l[e]})),i.value=!0,p="update",c.value="修改"},saveEdit:()=>{g.value.validate((e=>{if(!e)return!1;"add"==p?w(P).then((e=>{0==e.code?(f.success("新增成功"),g.value.resetFields(),i.value=!1,n()):f.error("新增失败")})).catch((()=>{f.error("新增失败")})):z(P).then((e=>{0==e.code?(f.success("修改成功"),g.value.resetFields(),i.value=!1,n()):f.error("修改失败")})).catch((()=>{f.error("修改失败")}))}))},handleAdd:()=>{i.value=!0,p="add",c.value="新增"},cancelEdit:()=>{g.value.resetFields(),i.value=!1},viewComment:(e,l)=>{s.value=!0,l.commentAairs&&(t.value=l.commentAairs,d.value=l.commentAairs.length)},handleCommentPageChange:e=>{r.pageIndex=e},handleCommentDelete:(e,l)=>{b.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{h(l.id).then((l=>{if(0==l.code){f.success("删除成功");let l=(r.pageIndex-1)*r.pageSize;t.value.splice(l+e,1),d.value=t.value.length}else f.error("删除失败")})).catch((()=>{f.error("删除失败")}))})).catch((()=>{}))},closeComment:()=>{s.value=!1,n()},trainTypeOptions:V}}},N={class:"crumbs"},_=t("i",{class:"el-icon-lx-cascades"},null,-1),q=s(" 火车信息管理 "),C={class:"container"},U={class:"handle-box"},T=s("搜索"),k=s("新增"),x=s("查看评论 "),D=s("编辑 "),S=s("删除"),Y={class:"pagination"},j=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),I=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),B=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),E=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),H=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),M=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),Q=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),L=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),$=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),A=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),F=t("div",{class:"message"},"有|表示充足,--|表示无此类型的座位,数字表示剩余座位数",-1),G={class:"dialog-footer"},O=s("取 消"),K=s("确 定"),R=s("删除"),J={class:"pagination"},W={class:"dialog-footer"},X=s("取 消"),Z=s("确 定");var ee=V(P,[["render",function(e,l,f,b,V,y){const w=a("el-breadcrumb-item"),z=a("el-breadcrumb"),v=a("el-input"),h=a("el-date-picker"),P=a("el-button"),ee=a("el-table-column"),le=a("el-table"),ae=a("el-pagination"),re=a("el-form-item"),oe=a("el-option"),ue=a("el-select"),te=a("el-time-picker"),me=a("el-form"),de=a("el-dialog"),ne=r("loading");return o(),u("div",null,[t("div",N,[m(z,{separator:"/"},{default:d((()=>[m(w,null,{default:d((()=>[_,q])),_:1})])),_:1})]),t("div",C,[t("div",U,[m(v,{modelValue:b.query.toStation,"onUpdate:modelValue":l[0]||(l[0]=e=>b.query.toStation=e),placeholder:"到达站点",class:"handle-input mr10"},null,8,["modelValue"]),m(h,{modelValue:b.query.fromDate,"onUpdate:modelValue":l[1]||(l[1]=e=>b.query.fromDate=e),placeholder:"发车日",type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",class:"mr10"},null,8,["modelValue"]),m(P,{type:"primary",icon:"el-icon-search",onClick:b.handleSearch},{default:d((()=>[T])),_:1},8,["onClick"]),m(P,{type:"primary",icon:"el-icon-lx-add",style:{float:"right"},onClick:b.handleAdd},{default:d((()=>[k])),_:1},8,["onClick"])]),n((o(),i(le,{data:b.tableData.slice((b.query.pageIndex-1)*b.query.pageSize,b.query.pageIndex*b.query.pageSize),border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:d((()=>[m(ee,{prop:"index",label:"序号",width:"50"},{default:d((e=>[s(p(e.$index+1),1)])),_:1}),m(ee,{prop:"trainCode",label:"车次"}),m(ee,{prop:"trainType",label:"车次类型"}),m(ee,{prop:"fromStation",label:"出发站点"}),m(ee,{prop:"toStation",label:"到达站点"}),m(ee,{prop:"fromDate",label:"发车日",width:"120"}),m(ee,{prop:"fromTime",label:"出发时间",width:"100"}),m(ee,{prop:"toTime",label:"到达时间",width:"100"}),m(ee,{prop:"runTime",label:"运行时间",width:"100"}),m(ee,{label:"操作",width:"250",align:"center"},{default:d((e=>[m(P,{type:"text",icon:"el-icon-edit",class:"opButton",onClick:l=>b.viewComment(e.$index,e.row)},{default:d((()=>[x])),_:2},1032,["onClick"]),m(P,{type:"text",icon:"el-icon-edit",class:"opButton",onClick:l=>b.handleEdit(e.$index,e.row)},{default:d((()=>[D])),_:2},1032,["onClick"]),m(P,{type:"text",icon:"el-icon-delete",class:"opButton red",onClick:l=>b.handleDelete(e.$index,e.row)},{default:d((()=>[S])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ne,b.loading]]),t("div",Y,[m(ae,{background:"",layout:"total, prev, pager, next","current-page":b.query.pageIndex,"page-size":b.query.pageSize,total:b.pageTotal,onCurrentChange:b.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),m(de,{title:b.dialogTitle,modelValue:b.editVisible,"onUpdate:modelValue":l[36]||(l[36]=e=>b.editVisible=e),width:"50%",onClose:b.cancelEdit},{footer:d((()=>[t("span",G,[m(P,{onClick:b.cancelEdit},{default:d((()=>[O])),_:1},8,["onClick"]),m(P,{type:"primary",onClick:b.saveEdit},{default:d((()=>[K])),_:1},8,["onClick"])])])),default:d((()=>[m(me,{"label-width":"150px",rules:b.rules,model:b.form,ref:"formRef"},{default:d((()=>[m(re,{label:"列车号",prop:"trainNo"},{default:d((()=>[m(v,{modelValue:b.form.trainNo,"onUpdate:modelValue":l[2]||(l[2]=e=>b.form.trainNo=e)},null,8,["modelValue"])])),_:1}),m(re,{label:"车次类型",prop:"trainType"},{default:d((()=>[m(ue,{modelValue:b.form.trainType,"onUpdate:modelValue":l[3]||(l[3]=e=>b.form.trainType=e),class:"m-2",size:"large"},{default:d((()=>[(o(!0),u(c,null,g(b.trainTypeOptions,(e=>(o(),i(oe,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(re,{label:"车次",prop:"trainCode"},{default:d((()=>[m(v,{modelValue:b.form.trainCode,"onUpdate:modelValue":l[4]||(l[4]=e=>b.form.trainCode=e)},null,8,["modelValue"])])),_:1}),m(re,{label:"出发站点",prop:"fromStation"},{default:d((()=>[m(ue,{modelValue:b.form.fromStation,"onUpdate:modelValue":l[5]||(l[5]=e=>b.form.fromStation=e),class:"m-2",size:"large"},{default:d((()=>[m(oe,{key:"11",label:"大连",value:"大连"}),m(oe,{key:"10",label:"大连北",value:"大连北"})])),_:1},8,["modelValue"])])),_:1}),m(re,{label:"到达站点",prop:"toStation"},{default:d((()=>[m(v,{modelValue:b.form.toStation,"onUpdate:modelValue":l[6]||(l[6]=e=>b.form.toStation=e)},null,8,["modelValue"])])),_:1}),m(re,{label:"发车日",prop:"fromDate"},{default:d((()=>[m(h,{modelValue:b.form.fromDate,"onUpdate:modelValue":l[7]||(l[7]=e=>b.form.fromDate=e),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),m(re,{label:"出发时间",prop:"fromTime"},{default:d((()=>[m(te,{modelValue:b.form.fromTime,"onUpdate:modelValue":l[8]||(l[8]=e=>b.form.fromTime=e),format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue"])])),_:1}),m(re,{label:"到达时间",prop:"toTime"},{default:d((()=>[m(te,{modelValue:b.form.toTime,"onUpdate:modelValue":l[9]||(l[9]=e=>b.form.toTime=e),format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue"])])),_:1}),m(re,{label:"运行时间(小时)",prop:"runTime"},{default:d((()=>[m(v,{modelValue:b.form.runTime,"onUpdate:modelValue":l[10]||(l[10]=e=>b.form.runTime=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"是否余票",prop:"canBook"},{default:d((()=>[m(ue,{modelValue:b.form.canBook,"onUpdate:modelValue":l[11]||(l[11]=e=>b.form.canBook=e),class:"m-2",size:"large"},{default:d((()=>[m(oe,{key:"1",label:"有余票",value:!0}),m(oe,{key:"0",label:"无余票",value:!1})])),_:1},8,["modelValue"])])),_:1}),m(re,{label:"商务座/特等座余票",prop:"swzNum"},{default:d((()=>[m(v,{modelValue:b.form.swzNum,"onUpdate:modelValue":l[12]||(l[12]=e=>b.form.swzNum=e)},null,8,["modelValue"]),j])),_:1}),m(re,{label:"商务座/特等座价格",prop:"swzPrice"},{default:d((()=>[m(v,{modelValue:b.form.swzPrice,"onUpdate:modelValue":l[13]||(l[13]=e=>b.form.swzPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"一等座余票",prop:"ydzNum"},{default:d((()=>[m(v,{modelValue:b.form.ydzNum,"onUpdate:modelValue":l[14]||(l[14]=e=>b.form.ydzNum=e)},null,8,["modelValue"]),I])),_:1}),m(re,{label:"一等座价格",prop:"ydzPrice"},{default:d((()=>[m(v,{modelValue:b.form.ydzPrice,"onUpdate:modelValue":l[15]||(l[15]=e=>b.form.ydzPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"二等座余票",prop:"edzNum"},{default:d((()=>[m(v,{modelValue:b.form.edzNum,"onUpdate:modelValue":l[16]||(l[16]=e=>b.form.edzNum=e)},null,8,["modelValue"]),B])),_:1}),m(re,{label:"二等座价格",prop:"edzPrice"},{default:d((()=>[m(v,{modelValue:b.form.edzPrice,"onUpdate:modelValue":l[17]||(l[17]=e=>b.form.edzPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"动卧余票",prop:"dwNum"},{default:d((()=>[m(v,{modelValue:b.form.dwNum,"onUpdate:modelValue":l[18]||(l[18]=e=>b.form.dwNum=e)},null,8,["modelValue"]),E])),_:1}),m(re,{label:"动卧价格",prop:"dwPrice"},{default:d((()=>[m(v,{modelValue:b.form.dwPrice,"onUpdate:modelValue":l[19]||(l[19]=e=>b.form.dwPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"高级软卧余票",prop:"gjrwNum"},{default:d((()=>[m(v,{modelValue:b.form.gjrwNum,"onUpdate:modelValue":l[20]||(l[20]=e=>b.form.gjrwNum=e)},null,8,["modelValue"]),H])),_:1}),m(re,{label:"高级软卧价格",prop:"gjrwPrice"},{default:d((()=>[m(v,{modelValue:b.form.gjrwPrice,"onUpdate:modelValue":l[21]||(l[21]=e=>b.form.gjrwPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"软卧/一等卧余票",prop:"rwNum"},{default:d((()=>[m(v,{modelValue:b.form.rwNum,"onUpdate:modelValue":l[22]||(l[22]=e=>b.form.rwNum=e)},null,8,["modelValue"]),M])),_:1}),m(re,{label:"软卧/一等卧价格",prop:"rwPrice"},{default:d((()=>[m(v,{modelValue:b.form.rwPrice,"onUpdate:modelValue":l[23]||(l[23]=e=>b.form.rwPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"硬卧余票",prop:"ywNum"},{default:d((()=>[m(v,{modelValue:b.form.ywNum,"onUpdate:modelValue":l[24]||(l[24]=e=>b.form.ywNum=e)},null,8,["modelValue"]),Q])),_:1}),m(re,{label:"硬卧价格",prop:"ywPrice"},{default:d((()=>[m(v,{modelValue:b.form.ywPrice,"onUpdate:modelValue":l[25]||(l[25]=e=>b.form.ywPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"软座余票",prop:"rzNum"},{default:d((()=>[m(v,{modelValue:b.form.rzNum,"onUpdate:modelValue":l[26]||(l[26]=e=>b.form.rzNum=e)},null,8,["modelValue"]),L])),_:1}),m(re,{label:"软座价格",prop:"rzPrice"},{default:d((()=>[m(v,{modelValue:b.form.rzPrice,"onUpdate:modelValue":l[27]||(l[27]=e=>b.form.rzPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"硬座余票",prop:"yzNum"},{default:d((()=>[m(v,{modelValue:b.form.yzNum,"onUpdate:modelValue":l[28]||(l[28]=e=>b.form.yzNum=e)},null,8,["modelValue"]),$])),_:1}),m(re,{label:"硬座价格",prop:"yzPrice"},{default:d((()=>[m(v,{modelValue:b.form.yzPrice,"onUpdate:modelValue":l[29]||(l[29]=e=>b.form.yzPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"无座余票",prop:"wzNum"},{default:d((()=>[m(v,{modelValue:b.form.wzNum,"onUpdate:modelValue":l[30]||(l[30]=e=>b.form.wzNum=e)},null,8,["modelValue"]),A])),_:1}),m(re,{label:"无座价格",prop:"wzPrice"},{default:d((()=>[m(v,{modelValue:b.form.wzPrice,"onUpdate:modelValue":l[31]||(l[31]=e=>b.form.wzPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"其他余票",prop:"qtNum"},{default:d((()=>[m(v,{modelValue:b.form.qtNum,"onUpdate:modelValue":l[32]||(l[32]=e=>b.form.qtNum=e)},null,8,["modelValue"]),F])),_:1}),m(re,{label:"其他价格",prop:"qtPrice"},{default:d((()=>[m(v,{modelValue:b.form.qtPrice,"onUpdate:modelValue":l[33]||(l[33]=e=>b.form.qtPrice=e),type:"number"},null,8,["modelValue"])])),_:1}),m(re,{label:"经停站点",prop:"trainLines"},{default:d((()=>[m(v,{modelValue:b.form.trainLines,"onUpdate:modelValue":l[34]||(l[34]=e=>b.form.trainLines=e),type:"textarea"},null,8,["modelValue"])])),_:1}),m(re,{label:"购票地址",prop:"buyUrl"},{default:d((()=>[m(v,{modelValue:b.form.buyUrl,"onUpdate:modelValue":l[35]||(l[35]=e=>b.form.buyUrl=e),type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue","onClose"]),m(de,{title:"评论",modelValue:b.commentVisible,"onUpdate:modelValue":l[37]||(l[37]=e=>b.commentVisible=e),width:"60%",onClose:b.closeComment},{footer:d((()=>[t("span",W,[m(P,{onClick:b.closeComment},{default:d((()=>[X])),_:1},8,["onClick"]),m(P,{type:"primary",onClick:b.closeComment},{default:d((()=>[Z])),_:1},8,["onClick"])])])),default:d((()=>[m(le,{data:b.commentTableData.slice((b.commentQuery.pageIndex-1)*b.commentQuery.pageSize,b.commentQuery.pageIndex*b.commentQuery.pageSize),border:"",class:"table",ref:"commentTable","header-cell-class-name":"table-header"},{default:d((()=>[m(ee,{prop:"index",label:"序号",width:"50"},{default:d((e=>[s(p(e.$index+1),1)])),_:1}),m(ee,{prop:"content",label:"评论内容"}),m(ee,{prop:"time",label:"评论时间"}),m(ee,{label:"操作",width:"180",align:"center"},{default:d((e=>[m(P,{type:"text",icon:"el-icon-delete",class:"opButton red",onClick:l=>b.handleCommentDelete(e.$index,e.row)},{default:d((()=>[R])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),t("div",J,[m(ae,{background:"",layout:"total, prev, pager, next","current-page":b.commentQuery.pageIndex,"page-size":b.commentQuery.pageSize,total:b.commentPageTotal,onCurrentChange:b.handleCommentPageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])),_:1},8,["modelValue","onClose"])])}]]);export{ee as default};
