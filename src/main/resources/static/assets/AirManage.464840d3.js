import{D as e,b as l,r as a,E as t,o,g as r,h as n,i,w as m,G as d,c as u,j as s,t as p,H as c,L as f}from"./vendor.c7f77ec0.js";import{_ as g,o as y,p as h,u as b,q as v,r as C}from"./index.01f492b5.js";const T={name:"airManage",setup(){const a=e({oapName:"大连",aapName:null,fromTime:null,flyOffOnlyTime:null,arrivalOnlyTime:null,pageIndex:1,pageSize:10}),t=e({pageIndex:1,pageSize:5}),o=l(!1),r=l([]),n=l([]),i=l(0),m=l(0),d=()=>{o.value=!0,y(a).then((e=>{0==e.code?(r.value=e.data,i.value=e.data.length):c.error(e.message),o.value=!1}))};d();const u=l(!1),s=l(!1);let p="add";const g=l("新增"),T=l(null);let V=e({id:null,oapName:"大连周水子国际机场",aapName:null,flyOffOnlyTime:null,arrivalOnlyTime:null,aep:null,fromTime:null,buyUrl:null,si:null,useTime:null});const x=e({oapName:[{required:!0,message:"请输入出发站点",trigger:"blur"}],aapName:[{required:!0,message:"请输入到达站点",trigger:"blur"}],fromTime:[{required:!0,message:"请选择出发日",trigger:"blur"}],flyOffOnlyTime:[{required:!0,message:"请选择出发时刻",trigger:"blur"}],arrivalOnlyTime:[{required:!0,message:"请选择到达时刻",trigger:"blur"}],useTime:[{required:!0,message:"请输入总用时",trigger:"blur"}],aep:[{required:!0,message:"请输入最低价格",trigger:"blur"}]});return{loading:o,query:a,commentQuery:t,tableData:r,commentTableData:n,pageTotal:i,commentPageTotal:m,editVisible:u,commentVisible:s,formRef:T,form:V,rules:x,dialogTitle:g,handleSearch:()=>{a.pageIndex=1,d()},handlePageChange:e=>{a.pageIndex=e},handleDelete:(e,l)=>{f.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{v(l.id).then((e=>{0==e.code?(c.success("删除成功"),d()):c.error("删除失败")})).catch((()=>{c.error("删除失败")}))})).catch((()=>{}))},handleEdit:(e,l)=>{Object.keys(V).forEach((e=>{V[e]=l[e]})),u.value=!0,p="update",g.value="修改"},saveEdit:()=>{T.value.validate((e=>{if(!e)return!1;"add"==p?h(V).then((e=>{0==e.code?(c.success("新增成功"),T.value.resetFields(),u.value=!1,d()):c.error("新增失败")})).catch((()=>{c.error("新增失败")})):b(V).then((e=>{0==e.code?(c.success("修改成功"),T.value.resetFields(),u.value=!1,d()):c.error("修改失败")})).catch((()=>{c.error("修改失败")}))}))},handleAdd:()=>{u.value=!0,p="add",g.value="新增"},cancelEdit:()=>{T.value.resetFields(),u.value=!1},viewComment:(e,l)=>{s.value=!0,l.commentAairs&&(n.value=l.commentAairs,m.value=l.commentAairs.length)},handleCommentPageChange:e=>{t.pageIndex=e},handleCommentDelete:(e,l)=>{f.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{C(l.id).then((l=>{if(0==l.code){c.success("删除成功");let l=(t.pageIndex-1)*t.pageSize;n.value.splice(l+e,1),m.value=n.value.length}else c.error("删除失败")})).catch((()=>{c.error("删除失败")}))})).catch((()=>{}))},closeComment:()=>{s.value=!1,d()},arrivalOnlyTimeChange:e=>{if(V.flyOffOnlyTime){let l=V.flyOffOnlyTime;if(l>e)return c.warning("出发时刻不能大于到达时刻"),void(V.useTime=null);let a=60*parseInt(l.split(":")[0])+parseInt(l.split(":")[1]),t=60*parseInt(e.split(":")[0])+parseInt(e.split(":")[1]);V.useTime=t-a}}}}},V={class:"crumbs"},x=n("i",{class:"el-icon-lx-cascades"},null,-1),_=s(" 航班信息管理 "),O={class:"container"},w={class:"handle-box"},k=s("搜索"),q=s("新增"),D=s("查看评论 "),U=s("编辑 "),I=s("删除"),N={class:"pagination"},Y=n("span",{class:"text-gray-500"},"-",-1),z={class:"dialog-footer"},S=s("取 消"),E=s("确 定"),H=s("删除"),M={class:"pagination"},Q={class:"dialog-footer"},P=s("取 消"),$=s("确 定");var A=g(T,[["render",function(e,l,c,f,g,y){const h=a("el-breadcrumb-item"),b=a("el-breadcrumb"),v=a("el-input"),C=a("el-date-picker"),T=a("el-button"),A=a("el-table-column"),j=a("el-table"),B=a("el-pagination"),F=a("el-form-item"),R=a("el-time-picker"),G=a("el-col"),L=a("el-form"),J=a("el-dialog"),K=t("loading");return o(),r("div",null,[n("div",V,[i(b,{separator:"/"},{default:m((()=>[i(h,null,{default:m((()=>[x,_])),_:1})])),_:1})]),n("div",O,[n("div",w,[i(v,{modelValue:f.query.aapName,"onUpdate:modelValue":l[0]||(l[0]=e=>f.query.aapName=e),placeholder:"到达站点",class:"handle-input mr10"},null,8,["modelValue"]),i(C,{modelValue:f.query.fromTime,"onUpdate:modelValue":l[1]||(l[1]=e=>f.query.fromTime=e),placeholder:"出发日",type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",class:"mr10"},null,8,["modelValue"]),i(T,{type:"primary",icon:"el-icon-search",onClick:f.handleSearch},{default:m((()=>[k])),_:1},8,["onClick"]),i(T,{type:"primary",icon:"el-icon-lx-add",style:{float:"right"},onClick:f.handleAdd},{default:m((()=>[q])),_:1},8,["onClick"])]),d((o(),u(j,{data:f.tableData.slice((f.query.pageIndex-1)*f.query.pageSize,f.query.pageIndex*f.query.pageSize),border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:m((()=>[i(A,{prop:"index",label:"序号",width:"50"},{default:m((e=>[s(p(e.$index+1),1)])),_:1}),i(A,{prop:"oapName",label:"出发站点"}),i(A,{prop:"aapName",label:"到达站点"}),i(A,{prop:"fromTime",label:"出发日",width:"120"}),i(A,{prop:"flyOffOnlyTime",label:"出发时刻",width:"100"}),i(A,{prop:"arrivalOnlyTime",label:"到达时刻",width:"100"}),i(A,{prop:"useTime",label:"总用时",width:"100"}),i(A,{prop:"aep",label:"价格",width:"100"}),i(A,{label:"操作",width:"250",align:"center"},{default:m((e=>[i(T,{type:"text",icon:"el-icon-lx-comment",class:"opButton",onClick:l=>f.viewComment(e.$index,e.row)},{default:m((()=>[D])),_:2},1032,["onClick"]),i(T,{type:"text",icon:"el-icon-edit",class:"opButton",onClick:l=>f.handleEdit(e.$index,e.row)},{default:m((()=>[U])),_:2},1032,["onClick"]),i(T,{type:"text",icon:"el-icon-delete",class:"opButton red",onClick:l=>f.handleDelete(e.$index,e.row)},{default:m((()=>[I])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[K,f.loading]]),n("div",N,[i(B,{background:"",layout:"total, prev, pager, next","current-page":f.query.pageIndex,"page-size":f.query.pageSize,total:f.pageTotal,onCurrentChange:f.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),i(J,{title:f.dialogTitle,modelValue:f.editVisible,"onUpdate:modelValue":l[11]||(l[11]=e=>f.editVisible=e),width:"30%",onClose:f.cancelEdit},{footer:m((()=>[n("span",z,[i(T,{onClick:f.cancelEdit},{default:m((()=>[S])),_:1},8,["onClick"]),i(T,{type:"primary",onClick:f.saveEdit},{default:m((()=>[E])),_:1},8,["onClick"])])])),default:m((()=>[i(L,{"label-width":"100px",rules:f.rules,model:f.form,ref:"formRef"},{default:m((()=>[i(F,{label:"出发站点",prop:"oapName"},{default:m((()=>[i(v,{modelValue:f.form.oapName,"onUpdate:modelValue":l[2]||(l[2]=e=>f.form.oapName=e),readonly:"true"},null,8,["modelValue"])])),_:1}),i(F,{label:"到达站点",prop:"aapName"},{default:m((()=>[i(v,{modelValue:f.form.aapName,"onUpdate:modelValue":l[3]||(l[3]=e=>f.form.aapName=e)},null,8,["modelValue"])])),_:1}),i(F,{label:"经停",prop:"si"},{default:m((()=>[i(v,{modelValue:f.form.si,"onUpdate:modelValue":l[4]||(l[4]=e=>f.form.si=e)},null,8,["modelValue"])])),_:1}),i(F,{label:"出发日",prop:"fromTime"},{default:m((()=>[i(C,{modelValue:f.form.fromTime,"onUpdate:modelValue":l[5]||(l[5]=e=>f.form.fromTime=e),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),i(F,{label:"时刻",required:""},{default:m((()=>[i(G,{span:11},{default:m((()=>[i(F,{prop:"flyOffOnlyTime"},{default:m((()=>[i(R,{placeholder:"出发时刻",modelValue:f.form.flyOffOnlyTime,"onUpdate:modelValue":l[6]||(l[6]=e=>f.form.flyOffOnlyTime=e),format:"HH:mm","value-format":"HH:mm",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),i(G,{class:"text-center",span:2,style:{width:"8.3333333333%","text-align":"center"}},{default:m((()=>[Y])),_:1}),i(G,{span:11},{default:m((()=>[i(F,{prop:"arrivalOnlyTime"},{default:m((()=>[i(R,{placeholder:"到达时刻",modelValue:f.form.arrivalOnlyTime,"onUpdate:modelValue":l[7]||(l[7]=e=>f.form.arrivalOnlyTime=e),format:"HH:mm","value-format":"HH:mm",style:{width:"100%"},onChange:f.arrivalOnlyTimeChange},null,8,["modelValue","onChange"])])),_:1})])),_:1})])),_:1}),i(F,{label:"总用时(min)",prop:"useTime"},{default:m((()=>[i(v,{modelValue:f.form.useTime,"onUpdate:modelValue":l[8]||(l[8]=e=>f.form.useTime=e),type:"number"},null,8,["modelValue"])])),_:1}),i(F,{label:"最低价格",prop:"aep"},{default:m((()=>[i(v,{modelValue:f.form.aep,"onUpdate:modelValue":l[9]||(l[9]=e=>f.form.aep=e),type:"number"},null,8,["modelValue"])])),_:1}),i(F,{label:"购票地址",prop:"buyUrl"},{default:m((()=>[i(v,{modelValue:f.form.buyUrl,"onUpdate:modelValue":l[10]||(l[10]=e=>f.form.buyUrl=e),type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue","onClose"]),i(J,{title:"评论",modelValue:f.commentVisible,"onUpdate:modelValue":l[12]||(l[12]=e=>f.commentVisible=e),width:"60%",onClose:f.closeComment},{footer:m((()=>[n("span",Q,[i(T,{onClick:f.closeComment},{default:m((()=>[P])),_:1},8,["onClick"]),i(T,{type:"primary",onClick:f.closeComment},{default:m((()=>[$])),_:1},8,["onClick"])])])),default:m((()=>[i(j,{data:f.commentTableData.slice((f.commentQuery.pageIndex-1)*f.commentQuery.pageSize,f.commentQuery.pageIndex*f.commentQuery.pageSize),border:"",class:"table",ref:"commentTable","header-cell-class-name":"table-header"},{default:m((()=>[i(A,{prop:"index",label:"序号",width:"50"},{default:m((e=>[s(p(e.$index+1),1)])),_:1}),i(A,{prop:"content",label:"评论内容"}),i(A,{prop:"time",label:"评论时间"}),i(A,{label:"操作",width:"180",align:"center"},{default:m((e=>[i(T,{type:"text",icon:"el-icon-delete",class:"opButton red",onClick:l=>f.handleCommentDelete(e.$index,e.row)},{default:m((()=>[H])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),n("div",M,[i(B,{background:"",layout:"total, prev, pager, next","current-page":f.commentQuery.pageIndex,"page-size":f.commentQuery.pageSize,total:f.commentPageTotal,onCurrentChange:f.handleCommentPageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])),_:1},8,["modelValue","onClose"])])}]]);export{A as default};
