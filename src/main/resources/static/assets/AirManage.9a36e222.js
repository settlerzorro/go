import{D as e,E as l,r as a,G as o,o as t,f as r,g as n,h as m,i as d,H as i,c as u,j as p,t as s,w as c,L as f}from"./vendor.17702b23.js";import{_ as g,g as b,i as y,u as h,d as v,a as C}from"./index.57ddd9f5.js";const V={name:"airManage",setup(){const a=e({oapName:"大连",aapName:null,fromTime:null,flyOffOnlyTime:null,arrivalOnlyTime:null,pageIndex:1,pageSize:10}),o=e({pageIndex:1,pageSize:5}),t=l(!1),r=l([]),n=l([]),m=l(0),d=l(0),i=()=>{t.value=!0,b(a).then((e=>{0==e.code?(r.value=e.data,m.value=e.data.length):c.error(e.message),t.value=!1}))};i();const u=l(!1),p=l(!1);let s="add";const g=l("新增"),V=l(null);let T=e({id:null,oapName:"大连周水子国际机场",aapName:null,flyOffOnlyTime:null,arrivalOnlyTime:null,aep:null,fromTime:null,buyUrl:null,si:null,useTime:null});const x=e({oapName:[{required:!0,message:"请输入出发站点",trigger:"blur"}],aapName:[{required:!0,message:"请输入到达站点",trigger:"blur"}],fromTime:[{required:!0,message:"请选择出发日",trigger:"blur"}],flyOffOnlyTime:[{required:!0,message:"请选择出发时刻",trigger:"blur"}],arrivalOnlyTime:[{required:!0,message:"请选择到达时刻",trigger:"blur"}],useTime:[{required:!0,message:"请输入总用时",trigger:"blur"}],aep:[{required:!0,message:"请输入最低价格",trigger:"blur"}]});return{loading:t,query:a,commentQuery:o,tableData:r,commentTableData:n,pageTotal:m,commentPageTotal:d,editVisible:u,commentVisible:p,formRef:V,form:T,rules:x,dialogTitle:g,handleSearch:()=>{a.pageIndex=1,i()},handlePageChange:e=>{a.pageIndex=e},handleDelete:(e,l)=>{f.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{v(l.id).then((e=>{0==e.code?(c.success("删除成功"),i()):c.error("删除失败")})).catch((()=>{c.error("删除失败")}))})).catch((()=>{}))},handleEdit:(e,l)=>{Object.keys(T).forEach((e=>{T[e]=l[e]})),u.value=!0,s="update",g.value="修改"},saveEdit:()=>{V.value.validate((e=>{if(!e)return!1;"add"==s?y(T).then((e=>{0==e.code?(c.success("新增成功"),V.value.resetFields(),u.value=!1,i()):c.error("新增失败")})).catch((()=>{c.error("新增失败")})):h(T).then((e=>{0==e.code?(c.success("修改成功"),V.value.resetFields(),u.value=!1,i()):c.error("修改失败")})).catch((()=>{c.error("修改失败")}))}))},handleAdd:()=>{u.value=!0,s="add",g.value="新增"},cancelEdit:()=>{V.value.resetFields(),u.value=!1},viewComment:(e,l)=>{p.value=!0,l.commentAairs&&(n.value=l.commentAairs,d.value=l.commentAairs.length)},handleCommentPageChange:e=>{o.pageIndex=e},handleCommentDelete:(e,l)=>{f.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{C(l.id).then((l=>{if(0==l.code){c.success("删除成功");let l=(o.pageIndex-1)*o.pageSize;n.value.splice(l+e,1),d.value=n.value.length}else c.error("删除失败")})).catch((()=>{c.error("删除失败")}))})).catch((()=>{}))},closeComment:()=>{p.value=!1,i()}}}},T={class:"crumbs"},x=n("i",{class:"el-icon-lx-cascades"},null,-1),_=p(" 航班信息管理 "),k={class:"container"},O={class:"handle-box"},w=p("搜索"),q=p("新增"),D=p("查看评论 "),U=p("编辑 "),N=p("删除"),Y={class:"pagination"},z={class:"dialog-footer"},I=p("取 消"),S=p("确 定"),E=p("删除"),H={class:"pagination"},M={class:"dialog-footer"},Q=p("取 消"),P=p("确 定");var $=g(V,[["render",function(e,l,c,f,g,b){const y=a("el-breadcrumb-item"),h=a("el-breadcrumb"),v=a("el-input"),C=a("el-date-picker"),V=a("el-button"),$=a("el-table-column"),A=a("el-table"),j=a("el-pagination"),B=a("el-form-item"),F=a("el-time-picker"),R=a("el-form"),G=a("el-dialog"),L=o("loading");return t(),r("div",null,[n("div",T,[m(h,{separator:"/"},{default:d((()=>[m(y,null,{default:d((()=>[x,_])),_:1})])),_:1})]),n("div",k,[n("div",O,[m(v,{modelValue:f.query.aapName,"onUpdate:modelValue":l[0]||(l[0]=e=>f.query.aapName=e),placeholder:"到达站点",class:"handle-input mr10"},null,8,["modelValue"]),m(C,{modelValue:f.query.fromTime,"onUpdate:modelValue":l[1]||(l[1]=e=>f.query.fromTime=e),placeholder:"出发日",type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",class:"mr10"},null,8,["modelValue"]),m(V,{type:"primary",icon:"el-icon-search",onClick:f.handleSearch},{default:d((()=>[w])),_:1},8,["onClick"]),m(V,{type:"primary",icon:"el-icon-lx-add",style:{float:"right"},onClick:f.handleAdd},{default:d((()=>[q])),_:1},8,["onClick"])]),i((t(),u(A,{data:f.tableData.slice((f.query.pageIndex-1)*f.query.pageSize,f.query.pageIndex*f.query.pageSize),border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:d((()=>[m($,{prop:"index",label:"序号",width:"50"},{default:d((e=>[p(s(e.$index+1),1)])),_:1}),m($,{prop:"oapName",label:"出发站点"}),m($,{prop:"aapName",label:"到达站点"}),m($,{prop:"fromTime",label:"出发日",width:"120"}),m($,{prop:"flyOffOnlyTime",label:"出发时刻",width:"100"}),m($,{prop:"arrivalOnlyTime",label:"到达时刻",width:"100"}),m($,{prop:"useTime",label:"总用时",width:"100"}),m($,{prop:"aep",label:"价格",width:"100"}),m($,{label:"操作",width:"250",align:"center"},{default:d((e=>[m(V,{type:"text",icon:"el-icon-edit",class:"opButton",onClick:l=>f.viewComment(e.$index,e.row)},{default:d((()=>[D])),_:2},1032,["onClick"]),m(V,{type:"text",icon:"el-icon-edit",class:"opButton",onClick:l=>f.handleEdit(e.$index,e.row)},{default:d((()=>[U])),_:2},1032,["onClick"]),m(V,{type:"text",icon:"el-icon-delete",class:"opButton red",onClick:l=>f.handleDelete(e.$index,e.row)},{default:d((()=>[N])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[L,f.loading]]),n("div",Y,[m(j,{background:"",layout:"total, prev, pager, next","current-page":f.query.pageIndex,"page-size":f.query.pageSize,total:f.pageTotal,onCurrentChange:f.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),m(G,{title:f.dialogTitle,modelValue:f.editVisible,"onUpdate:modelValue":l[11]||(l[11]=e=>f.editVisible=e),width:"30%",onClose:f.cancelEdit},{footer:d((()=>[n("span",z,[m(V,{onClick:f.cancelEdit},{default:d((()=>[I])),_:1},8,["onClick"]),m(V,{type:"primary",onClick:f.saveEdit},{default:d((()=>[S])),_:1},8,["onClick"])])])),default:d((()=>[m(R,{"label-width":"100px",rules:f.rules,model:f.form,ref:"formRef"},{default:d((()=>[m(B,{label:"出发站点",prop:"oapName"},{default:d((()=>[m(v,{modelValue:f.form.oapName,"onUpdate:modelValue":l[2]||(l[2]=e=>f.form.oapName=e),readonly:"true"},null,8,["modelValue"])])),_:1}),m(B,{label:"到达站点",prop:"aapName"},{default:d((()=>[m(v,{modelValue:f.form.aapName,"onUpdate:modelValue":l[3]||(l[3]=e=>f.form.aapName=e)},null,8,["modelValue"])])),_:1}),m(B,{label:"经停",prop:"si"},{default:d((()=>[m(v,{modelValue:f.form.si,"onUpdate:modelValue":l[4]||(l[4]=e=>f.form.si=e)},null,8,["modelValue"])])),_:1}),m(B,{label:"出发日",prop:"fromTime"},{default:d((()=>[m(C,{modelValue:f.form.fromTime,"onUpdate:modelValue":l[5]||(l[5]=e=>f.form.fromTime=e),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),m(B,{label:"出发时刻",prop:"flyOffOnlyTime"},{default:d((()=>[m(F,{modelValue:f.form.flyOffOnlyTime,"onUpdate:modelValue":l[6]||(l[6]=e=>f.form.flyOffOnlyTime=e),format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue"])])),_:1}),m(B,{label:"到达时刻",prop:"arrivalOnlyTime"},{default:d((()=>[m(F,{modelValue:f.form.arrivalOnlyTime,"onUpdate:modelValue":l[7]||(l[7]=e=>f.form.arrivalOnlyTime=e),format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue"])])),_:1}),m(B,{label:"总用时(min)",prop:"useTime"},{default:d((()=>[m(v,{modelValue:f.form.useTime,"onUpdate:modelValue":l[8]||(l[8]=e=>f.form.useTime=e),type:"number"},null,8,["modelValue"])])),_:1}),m(B,{label:"最低价格",prop:"aep"},{default:d((()=>[m(v,{modelValue:f.form.aep,"onUpdate:modelValue":l[9]||(l[9]=e=>f.form.aep=e),type:"number"},null,8,["modelValue"])])),_:1}),m(B,{label:"购票地址",prop:"buyUrl"},{default:d((()=>[m(v,{modelValue:f.form.buyUrl,"onUpdate:modelValue":l[10]||(l[10]=e=>f.form.buyUrl=e),type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue","onClose"]),m(G,{title:"评论",modelValue:f.commentVisible,"onUpdate:modelValue":l[12]||(l[12]=e=>f.commentVisible=e),width:"60%",onClose:f.closeComment},{footer:d((()=>[n("span",M,[m(V,{onClick:f.closeComment},{default:d((()=>[Q])),_:1},8,["onClick"]),m(V,{type:"primary",onClick:f.closeComment},{default:d((()=>[P])),_:1},8,["onClick"])])])),default:d((()=>[m(A,{data:f.commentTableData.slice((f.commentQuery.pageIndex-1)*f.commentQuery.pageSize,f.commentQuery.pageIndex*f.commentQuery.pageSize),border:"",class:"table",ref:"commentTable","header-cell-class-name":"table-header"},{default:d((()=>[m($,{prop:"index",label:"序号",width:"50"},{default:d((e=>[p(s(e.$index+1),1)])),_:1}),m($,{prop:"content",label:"评论内容"}),m($,{prop:"time",label:"评论时间"}),m($,{label:"操作",width:"180",align:"center"},{default:d((e=>[m(V,{type:"text",icon:"el-icon-delete",class:"opButton red",onClick:l=>f.handleCommentDelete(e.$index,e.row)},{default:d((()=>[E])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),n("div",H,[m(j,{background:"",layout:"total, prev, pager, next","current-page":f.commentQuery.pageIndex,"page-size":f.commentQuery.pageSize,total:f.commentPageTotal,onCurrentChange:f.handleCommentPageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])),_:1},8,["modelValue","onClose"])])}]]);export{$ as default};
