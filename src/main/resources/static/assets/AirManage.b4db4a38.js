import{d as e,b as l,r as a,h as t,o,i as r,j as n,k as m,w as d,n as i,c as u,m as s,t as p,H as c,L as f}from"./vendor.ce047f19.js";import{_ as g,o as h,p as y,u as b,q as v,r as V}from"./index.3af46441.js";const C={name:"airManage",setup(){const a=e({oapName:"大连",aapName:null,fromTime:null,flyOffOnlyTime:null,arrivalOnlyTime:null,pageIndex:1,pageSize:10}),t=e({pageIndex:1,pageSize:5}),o=l(!1),r=l([]),n=l([]),m=l(0),d=l(0),i=()=>{o.value=!0,h(a).then((e=>{0==e.code?(r.value=e.data,m.value=e.data.length):c.error(e.message),o.value=!1}))};i();const u=l(!1),s=l(!1);let p="add";const g=l("新增"),C=l(null);let T=e({id:null,oapName:"大连周水子国际机场",aapName:null,flyOffOnlyTime:null,arrivalOnlyTime:null,aep:null,fromTime:null,buyUrl:null,si:null,useTime:null,weather:null,scenicSpots:null});const x=e({oapName:[{required:!0,message:"请输入出发站点",trigger:"blur"}],aapName:[{required:!0,message:"请输入到达站点",trigger:"blur"}],fromTime:[{required:!0,message:"请选择出发日",trigger:"blur"}],flyOffOnlyTime:[{required:!0,message:"请选择出发时刻",trigger:"blur"}],arrivalOnlyTime:[{required:!0,message:"请选择到达时刻",trigger:"blur"}],useTime:[{required:!0,message:"请输入总用时",trigger:"blur"}],aep:[{required:!0,message:"请输入最低价格",trigger:"blur"}]});return{loading:o,query:a,commentQuery:t,tableData:r,commentTableData:n,pageTotal:m,commentPageTotal:d,editVisible:u,commentVisible:s,formRef:C,form:T,rules:x,dialogTitle:g,handleSearch:()=>{a.pageIndex=1,i()},handlePageChange:e=>{a.pageIndex=e},handleDelete:(e,l)=>{f.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{v(l.id).then((e=>{0==e.code?(c.success("删除成功"),i()):c.error("删除失败")})).catch((()=>{c.error("删除失败")}))})).catch((()=>{}))},handleEdit:(e,l)=>{Object.keys(T).forEach((e=>{T[e]=l[e]})),u.value=!0,p="update",g.value="修改"},saveEdit:()=>{C.value.validate((e=>{if(!e)return!1;"add"==p?y(T).then((e=>{0==e.code?(c.success("新增成功"),C.value.resetFields(),u.value=!1,i()):c.error("新增失败")})).catch((()=>{c.error("新增失败")})):b(T).then((e=>{0==e.code?(c.success("修改成功"),C.value.resetFields(),u.value=!1,i()):c.error("修改失败")})).catch((()=>{c.error("修改失败")}))}))},handleAdd:()=>{u.value=!0,p="add",g.value="新增"},cancelEdit:()=>{C.value.resetFields(),u.value=!1},viewComment:(e,l)=>{s.value=!0,l.commentAairs&&(n.value=l.commentAairs,d.value=l.commentAairs.length)},handleCommentPageChange:e=>{t.pageIndex=e},handleCommentDelete:(e,l)=>{f.confirm("确定要删除吗？","提示",{type:"warning"}).then((()=>{V(l.id).then((l=>{if(0==l.code){c.success("删除成功");let l=(t.pageIndex-1)*t.pageSize;n.value.splice(l+e,1),d.value=n.value.length}else c.error("删除失败")})).catch((()=>{c.error("删除失败")}))})).catch((()=>{}))},closeComment:()=>{s.value=!1,i()},arrivalOnlyTimeChange:e=>{if(T.flyOffOnlyTime){let l=T.flyOffOnlyTime;if(l>e)return c.warning("出发时刻不能大于到达时刻"),void(T.useTime=null);let a=60*parseInt(l.split(":")[0])+parseInt(l.split(":")[1]),t=60*parseInt(e.split(":")[0])+parseInt(e.split(":")[1]);T.useTime=t-a}}}}},T={class:"crumbs"},x=n("i",{class:"el-icon-lx-cascades"},null,-1),_=s(" 航班信息管理 "),w={class:"container"},O={class:"handle-box"},k=s("搜索"),q=s("新增"),U=s("查看评论 "),D=s("编辑 "),I=s("删除"),N={class:"pagination"},Y=n("span",{class:"text-gray-500"},"-",-1),S={class:"dialog-footer"},z=s("取 消"),H=s("确 定"),M=s("删除"),E={class:"pagination"},Q={class:"dialog-footer"},P=s("取 消"),$=s("确 定");var A=g(C,[["render",function(e,l,c,f,g,h){const y=a("el-breadcrumb-item"),b=a("el-breadcrumb"),v=a("el-input"),V=a("el-date-picker"),C=a("el-button"),A=a("el-table-column"),j=a("el-table"),B=a("el-pagination"),F=a("el-form-item"),R=a("el-time-picker"),L=a("el-col"),G=a("el-form"),J=a("el-dialog"),K=t("loading");return o(),r("div",null,[n("div",T,[m(b,{separator:"/"},{default:d((()=>[m(y,null,{default:d((()=>[x,_])),_:1})])),_:1})]),n("div",w,[n("div",O,[m(v,{modelValue:f.query.aapName,"onUpdate:modelValue":l[0]||(l[0]=e=>f.query.aapName=e),placeholder:"到达站点",class:"handle-input mr10"},null,8,["modelValue"]),m(V,{modelValue:f.query.fromTime,"onUpdate:modelValue":l[1]||(l[1]=e=>f.query.fromTime=e),placeholder:"出发日",type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",class:"mr10"},null,8,["modelValue"]),m(C,{type:"primary",icon:"el-icon-search",onClick:f.handleSearch},{default:d((()=>[k])),_:1},8,["onClick"]),m(C,{type:"primary",icon:"el-icon-lx-add",style:{float:"right"},onClick:f.handleAdd},{default:d((()=>[q])),_:1},8,["onClick"])]),i((o(),u(j,{data:f.tableData.slice((f.query.pageIndex-1)*f.query.pageSize,f.query.pageIndex*f.query.pageSize),border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:d((()=>[m(A,{prop:"index",label:"序号",width:"50"},{default:d((e=>[s(p(e.$index+1),1)])),_:1}),m(A,{prop:"oapName",label:"出发站点"}),m(A,{prop:"aapName",label:"到达站点"}),m(A,{prop:"fromTime",label:"出发日",width:"120"}),m(A,{prop:"flyOffOnlyTime",label:"出发时刻",width:"100"}),m(A,{prop:"arrivalOnlyTime",label:"到达时刻",width:"100"}),m(A,{prop:"useTime",label:"总用时",width:"100"}),m(A,{prop:"aep",label:"价格",width:"100"}),m(A,{label:"操作",width:"250",align:"center"},{default:d((e=>[m(C,{type:"text",icon:"el-icon-lx-comment",class:"opButton",onClick:l=>f.viewComment(e.$index,e.row)},{default:d((()=>[U])),_:2},1032,["onClick"]),m(C,{type:"text",icon:"el-icon-edit",class:"opButton",onClick:l=>f.handleEdit(e.$index,e.row)},{default:d((()=>[D])),_:2},1032,["onClick"]),m(C,{type:"text",icon:"el-icon-delete",class:"opButton red",onClick:l=>f.handleDelete(e.$index,e.row)},{default:d((()=>[I])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[K,f.loading]]),n("div",N,[m(B,{background:"",layout:"total, prev, pager, next","current-page":f.query.pageIndex,"page-size":f.query.pageSize,total:f.pageTotal,onCurrentChange:f.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),m(J,{title:f.dialogTitle,modelValue:f.editVisible,"onUpdate:modelValue":l[13]||(l[13]=e=>f.editVisible=e),width:"30%",onClose:f.cancelEdit},{footer:d((()=>[n("span",S,[m(C,{onClick:f.cancelEdit},{default:d((()=>[z])),_:1},8,["onClick"]),m(C,{type:"primary",onClick:f.saveEdit},{default:d((()=>[H])),_:1},8,["onClick"])])])),default:d((()=>[m(G,{"label-width":"100px",rules:f.rules,model:f.form,ref:"formRef"},{default:d((()=>[m(F,{label:"出发站点",prop:"oapName"},{default:d((()=>[m(v,{modelValue:f.form.oapName,"onUpdate:modelValue":l[2]||(l[2]=e=>f.form.oapName=e),readonly:"true"},null,8,["modelValue"])])),_:1}),m(F,{label:"到达站点",prop:"aapName"},{default:d((()=>[m(v,{modelValue:f.form.aapName,"onUpdate:modelValue":l[3]||(l[3]=e=>f.form.aapName=e)},null,8,["modelValue"])])),_:1}),m(F,{label:"经停",prop:"si"},{default:d((()=>[m(v,{modelValue:f.form.si,"onUpdate:modelValue":l[4]||(l[4]=e=>f.form.si=e)},null,8,["modelValue"])])),_:1}),m(F,{label:"出发日",prop:"fromTime"},{default:d((()=>[m(V,{modelValue:f.form.fromTime,"onUpdate:modelValue":l[5]||(l[5]=e=>f.form.fromTime=e),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),m(F,{label:"时刻",required:""},{default:d((()=>[m(L,{span:11},{default:d((()=>[m(F,{prop:"flyOffOnlyTime"},{default:d((()=>[m(R,{placeholder:"出发时刻",modelValue:f.form.flyOffOnlyTime,"onUpdate:modelValue":l[6]||(l[6]=e=>f.form.flyOffOnlyTime=e),format:"HH:mm","value-format":"HH:mm",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1}),m(L,{class:"text-center",span:2,style:{width:"8.3333333333%","text-align":"center"}},{default:d((()=>[Y])),_:1}),m(L,{span:11},{default:d((()=>[m(F,{prop:"arrivalOnlyTime"},{default:d((()=>[m(R,{placeholder:"到达时刻",modelValue:f.form.arrivalOnlyTime,"onUpdate:modelValue":l[7]||(l[7]=e=>f.form.arrivalOnlyTime=e),format:"HH:mm","value-format":"HH:mm",style:{width:"100%"},onChange:f.arrivalOnlyTimeChange},null,8,["modelValue","onChange"])])),_:1})])),_:1})])),_:1}),m(F,{label:"总用时(min)",prop:"useTime"},{default:d((()=>[m(v,{modelValue:f.form.useTime,"onUpdate:modelValue":l[8]||(l[8]=e=>f.form.useTime=e),type:"number"},null,8,["modelValue"])])),_:1}),m(F,{label:"最低价格",prop:"aep"},{default:d((()=>[m(v,{modelValue:f.form.aep,"onUpdate:modelValue":l[9]||(l[9]=e=>f.form.aep=e),type:"number"},null,8,["modelValue"])])),_:1}),m(F,{label:"目的地天气",prop:"weather"},{default:d((()=>[m(v,{modelValue:f.form.weather,"onUpdate:modelValue":l[10]||(l[10]=e=>f.form.weather=e)},null,8,["modelValue"])])),_:1}),m(F,{label:"目的地景点",prop:"scenicSpots"},{default:d((()=>[m(v,{modelValue:f.form.scenicSpots,"onUpdate:modelValue":l[11]||(l[11]=e=>f.form.scenicSpots=e)},null,8,["modelValue"])])),_:1}),m(F,{label:"购票地址",prop:"buyUrl"},{default:d((()=>[m(v,{modelValue:f.form.buyUrl,"onUpdate:modelValue":l[12]||(l[12]=e=>f.form.buyUrl=e),type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["title","modelValue","onClose"]),m(J,{title:"评论",modelValue:f.commentVisible,"onUpdate:modelValue":l[14]||(l[14]=e=>f.commentVisible=e),width:"60%",onClose:f.closeComment},{footer:d((()=>[n("span",Q,[m(C,{onClick:f.closeComment},{default:d((()=>[P])),_:1},8,["onClick"]),m(C,{type:"primary",onClick:f.closeComment},{default:d((()=>[$])),_:1},8,["onClick"])])])),default:d((()=>[m(j,{data:f.commentTableData.slice((f.commentQuery.pageIndex-1)*f.commentQuery.pageSize,f.commentQuery.pageIndex*f.commentQuery.pageSize),border:"",class:"table",ref:"commentTable","header-cell-class-name":"table-header"},{default:d((()=>[m(A,{prop:"index",label:"序号",width:"50"},{default:d((e=>[s(p(e.$index+1),1)])),_:1}),m(A,{prop:"content",label:"评论内容"}),m(A,{prop:"time",label:"评论时间"}),m(A,{label:"操作",width:"180",align:"center"},{default:d((e=>[m(C,{type:"text",icon:"el-icon-delete",class:"opButton red",onClick:l=>f.handleCommentDelete(e.$index,e.row)},{default:d((()=>[M])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),n("div",E,[m(B,{background:"",layout:"total, prev, pager, next","current-page":f.commentQuery.pageIndex,"page-size":f.commentQuery.pageSize,total:f.commentPageTotal,onCurrentChange:f.handleCommentPageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])),_:1},8,["modelValue","onClose"])])}]]);export{A as default};
